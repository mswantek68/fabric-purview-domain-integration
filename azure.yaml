name: ai-fabric-foundry
infra:
  provider: bicep
hooks:
  postprovision:
    - run: ./scripts/00_cleanup_environment.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/Fabric_Purview_Automation/ensure_active_capacity.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/Fabric_Purview_Automation/create_fabric_domain.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/Fabric_Purview_Automation/create_fabric_workspace.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/Fabric_Purview_Automation/assign_workspace_to_domain.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/Fabric_Purview_Automation/create_purview_collection.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/Fabric_Purview_Automation/register_fabric_datasource.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/Fabric_Purview_Automation/connect_log_analytics.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/Fabric_Purview_Automation/create_lakehouses.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/Fabric_Purview_Automation/materialize_document_folders.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/OneLakeIndex/01_setup_rbac.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/OneLakeIndex/02_create_onelake_skillsets.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/OneLakeIndex/03_create_onelake_index.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/OneLakeIndex/04_create_onelake_datasource.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/OneLakeIndex/05_create_onelake_indexer.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/OneLakeIndex/06_setup_ai_foundry_search_rbac.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/OneLakeIndex/07_automate_ai_foundry_connection.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/Fabric_Purview_Automation/trigger_purview_scan_for_fabric_workspace.ps1
      interactive: false
      shell: pwsh
    # Purview Governance - DSPM for AI
    - run: ./scripts/PurviewGovernance/enable_purview_dspm.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/PurviewGovernance/create_dspm_policies.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/PurviewGovernance/connect_dspm_to_ai_foundry.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/PurviewGovernance/verify_dspm_configuration.ps1
      interactive: false
      shell: pwsh
    # Microsoft Defender for AI
    - run: ./scripts/DefenderScripts/enable_defender_for_cloud.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/DefenderScripts/enable_defender_for_ai.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/DefenderScripts/enable_user_prompt_evidence.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/DefenderScripts/connect_defender_to_purview.ps1
      interactive: false
      shell: pwsh
    - run: ./scripts/DefenderScripts/verify_defender_ai_configuration.ps1
      interactive: false
      shell: pwsh
metadata:
  template: ''